<div id="mission-description">
  <div class="small-card-white">
    <h3 class="text-left">Mission: <%= booking.service.title %></h3>
    <ul class="text-left list-inline">
      <li>Conditions: </li>
      <li>
        <% if booking.starts_at %>
          <i class="fa fa-calendar"></i> <%= booking.starts_at.strftime("%A %d %B") %>  |
        <% else %>
          <i class="fa fa-calendar"></i> A fixer  |
        <% end %>
      </li>
      <li>
        <i class="fa fa-clock-o"></i>
        <% if booking.duration.nil? %>
          A fixer  |
        <% else %>
          <%= booking.duration %> h  |
        <% end%>
      </li>
      <li><i class="fa fa-money"></i> A fixer</li>
    </ul>
  </div>
  <div class="small-card-white">
    <ul class="text-center list-inline">
      <li>
        <span class="<%= booking.status_style %>"><%= booking.status %></span>
      </li>
      <% if current_user == booking.service.user %>
        <li>
          <% if booking.status == "Demande d'information" %>
            <!-- Button trigger modal -->
            <button type="button" class="btn buttonMission" data-toggle="modal" data-target="#myModal">
                Répondre
            </button>
          <% elsif booking.status == "En discussion" %>
            <!-- Button trigger modal -->
            <button type="button" class="btn buttonMission" data-toggle="modal" data-target="#myModal">
                Mettre à jour la mission
            </button>
          <% elsif booking.status == "En attente de réalisation" %>
            <%= button_to 'Mission Réalisée!', {controller: :bookings, action: :mission_done, id: booking.id }, method: :patch, class:'btn buttonMissionGreen' %>
          <% end %>
        </li>
      <% end %>
      <% if current_user == booking.user %>
        <% if booking.status == "En attente de validation" %>
          <li>
            <%= button_to 'Valider', {controller: :bookings, action: :accept, id: booking.id }, method: :patch, class:'btn buttonMissionGreen' %>
          </li>
          <li>
            <%= button_to 'Refuser', {controller: :bookings, action: :refuse, id: booking.id }, method: :patch, class:'btn buttonMissionGrey' %>
          </li>
        <% end %>
      <% end %>
    </ul>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title text-left text-major-action-color" id="myModalLabel">Mise au point de la mission</h4>
      </div>
      <div class="modal-body">
        <div id="edit-mission">
          <p id="modal-precision"><strong>Note:</strong> Répondez à XXX et mettez à jour les conditions de la mission.</p>
        <!-- Mission Edit -->
          <%= simple_form_for([loge, booking]) do |f| %>
            <%= f.simple_fields_for :messages, [expert_message] do |message_form| %>
              <%= message_form.input :user_id, as: :hidden %>
              <%= message_form.input :content, label:"Votre réponse", as: :text %>
            <% end %>
              <div class="row">
                <div class="col-xs-5">
                  <%= f.input :starts_at, label:"Date de la mission", as: :string, :input_html => { data: {behaviour: "modal-datepicker"}} %>
                </div>
                <div class="col-xs-1">
                </div>
                <div class="col-xs-5">
                  <%= f.input :duration, label: "Durée prévue en heure", placeholder: "Durée prévue" %>
                </div>
              </div>
            <p>Prix<p>

            <%= f.button :submit, "Proposer", class: "buttonChat" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
